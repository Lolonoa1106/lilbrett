(self["webpackChunk_canva_web"] = self["webpackChunk_canva_web"] || []).push([[5024],{

/***/ 376699:
function(_, __, __webpack_require__) {__webpack_require__.n_x = __webpack_require__.n;const __web_req__ = __webpack_require__;__web_req__(813110);__web_req__(558104);self._fe4d99ebe0d2d259646a80d250150d47 = self._fe4d99ebe0d2d259646a80d250150d47 || {};(function(__c) {var wc=__c.wc;var Kc=__c.Kc;var zt=__c.zt;var P=__c.P;var fw=__c.fw;var Sg=__c.Sg;var nj=__c.nj;var B=__c.B;var hg=__c.hg;var D=__c.D;var O=__c.O;
var nAb=function(a){switch(a){case 4:return O("9ND0kg");case 2:return O("ibdecg");case 7:return O("446quA");case 5:return O("j1fbqg");case 1:return O("O5i4AQ");case 6:return O("C0VHsg");case 3:return O("+IXmVg");default:throw new D(a);}},oAb=function(a){return b=>({type:"react",node:(0,__c.N)(a,{...b})})},pAb=function(a){return b=>({type:"dom",render:c=>a(b,c)})},rAb=function(a){var b,c=a.qw,d=a.content;a=a.context;__c.y("formula"===(null===d||void 0===d?void 0:null===(b=d.Qg)||void 0===b?void 0:
b.type));b=d.Qg.value;switch(b.type){case "invalid":b=b.N6;break;case "canonical":b=b.YG;break;default:throw new D(b);}__c.y(b.startsWith("="));const e=d.VH;b={type:"dom",render:h=>h.innerText=""};let f;switch(e.type){case 6:f=b;break;case 1:case 3:case 4:case 2:case 5:f=qAb(c,a,d.Cu);break;case 0:f={type:"react",node:Q5(__c.UT,{label:nAb(e.error),children:Q5(__c.lO,{width:"full",display:"flex",justifyContent:"center",children:Q5(__c.Oeb,{tone:"critical"})})})};break;default:throw new D(e);}if(!f)return b;
c=hg(__c.kS,a.attrs);d=__c.CI(a.attrs.textAlign,"formula",void 0,()=>e.type);const g={textAlign:__c.Qsa(d,c.direction),justifyContent:__c.Rsa(d)};switch(f.type){case "dom":return{type:"dom",render:h=>{Object.assign(h.style,g);f.render(h)}};case "react":return{type:"react",node:Q5("div",{style:g,children:f.node})};default:throw new D(f);}},qAb=function(a,b,c){var d;return null===(d=a.U$)||void 0===d?void 0:d.call(a,{context:b,value:c})},vAb=function(a){const b=a.qw,c=a.jh;a=a.n7a;b.U$=sAb;b.qqa=d=>
rAb({...d,qw:b});b.rqa=oAb(tAb({jh:c,hR:void 0}));b.tqa=uAb(a);b.uqa=oAb(R5)},wAb=function(a,b,c){const d=[a];for(;null!=a&&a!==b;)(a=c.next(a))&&d.push(a);return d},xAb=function({label:a,width:b,height:c,scale:d,highlight:e,selected:f}){return Q5("div",{style:{width:b,height:c,transform:`scale(${d})`},className:"bx74uQ",children:Q5(__c.lv,{className:S5({yiml1g:e,oYlhXA:f}),size:"small",alignment:"center",children:a})})},zAb=function({ad:a,highlight:b,scale:c,ev:d,Qm:e,zKa:f}){const g=T5(()=>{const m=
null===d||void 0===d?void 0:d.get();if(null!=m&&0!==m.length)return new __c.pE(m)},[d]),h=e(1),k=e(c),l={ssE9Tg:!a,OkifGQ:a};return Q5(__c.mv,{Vn:"light",light:"light",Eq:"light",dark:"light",children:m=>Q5("div",{className:S5("ze9QCQ",l,m.className),style:{width:k,height:k},children:Q5("div",{style:{width:h,height:h,transform:`scale(${c})`},className:S5("N7J3UA",l),ref:null===g||void 0===g?void 0:g.Xf,children:Q5(__c.mO,{className:S5("m8CFdg",l,{G6wL4w:f,W_E0wA:b}),ariaLabel:O("ruWN9A"),children:Q5(yAb,
{size:"tiny"})})})})})},BAb=function(){const a=new AAb,b=new __c.RZ,c=U5(f=>{const {scale:g=1,size:h="small",zKa:k=!0}=f,l=V5(m=>a.Qm(m,h),[h]);return Q5(zAb,{...f,scale:g,ad:"rtl"===f.sheet.direction,highlight:null!=f.selection&&a.TYa(f.sheet,f.selection),Qm:l,zKa:k})}),d=U5(f=>{const {scale:g=1,size:h="small"}=f,k=V5(n=>a.Qm(n,h),[h]),l=V5(n=>null!=f.selection&&a.UFa(f.selection).has(n),[f.selection]),m=V5(n=>null!=f.selection&&a.bXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return Q5(W5,
{...f,scale:g,Qm:k,Xya:l,MGa:m,JO:b})}),e=U5(f=>{const {scale:g=1,size:h="small"}=f,k=V5(n=>a.Qm(n,h),[h]),l=V5(n=>null!=f.selection&&a.WFa(f.selection).has(n),[f.selection]),m=V5(n=>null!=f.selection&&a.cXa(f.sheet,f.selection).has(n),[f.sheet,f.selection]);return Q5(X5,{...f,scale:g,Qm:k,NGa:m,sza:l,JO:b})});return{YKa:c,XKa:d,ZKa:e}},CAb=function(a){const b=a.qq,c=()=>null;return __c.Yt(d=>Q5(Y5,{...d,qq:b,Oj:c}))},FAb=function({onScroll:a}){const b=new DAb(a);return{EF:b,E$:U5(c=>Q5(EAb,{sheet:c.sheet,
EF:b,children:c.children}))}},HAb=function(a){const b=a.qq,c=a.Td,d=a.DGa,e=({children:k})=>k,{EF:f,E$:g}=FAb({onScroll:a.onScroll});class h extends GAb{get FG(){const k=this.props.Eb.TD;switch(k){case "screen":return g;case "print":return e;default:throw new D(k);}}componentDidMount(){d.tGa(this.props.item,{Ub:this.props.Ub,Eb:this.props.Eb,Cg:this.props.Cg})}componentWillUnmount(){d.$Pa(this.props.item,{Ub:this.props.Ub,Eb:this.props.Eb,Cg:this.props.Cg})}render(){d.tGa(this.props.item,{Ub:this.props.Ub,
Eb:this.props.Eb,Cg:this.props.Cg});return Q5(Z5,{...this.props,scaleFactor:this.scaleFactor,qq:b,Td:c,FG:this.FG,DGa:d})}constructor(...k){super(...k);this.scaleFactor=$5(()=>{const l=this.props.item;var m=this.props.Eb,n=m.TD;m=m.zoom;switch(n){case "screen":return 1;case "print":n=d.uWa(l);if(!n)return 1;({width:n}=new __c.Ew(l,n.Ub,{zoom:m}));return n/l.config.width;default:throw new D(n);}})}}return{RMa:h,EF:f}},IAb=function(a,b){if(null!=b&&null!=b.oc&&null!=b.uc&&null!=b.yd&&null!=b.Jd){var c=
a.qa(b.oc),d=a.ra(b.uc),e=a.qa(b.yd)+b.yd.width-c;a=a.ra(b.Jd)+b.Jd.height-d;return __c.is({top:d,left:c,width:e,height:a})}},KAb=function(a){const b=a.qq,c=()=>null;return d=>Q5(JAb,{...d,qq:b,Oj:c})},LAb=function(a,b,c){return a<c&&c<b},PAb=function(a,b,c,d,e){if(0===c.length||0===d.length)return[];const f=MAb(a,b,c,d,e);e=NAb(a,b,c,d,e);const g=OAb(a,b,c,d),h=a.qWa(b),k=a.PVa(b),l="rtl"===b.direction;a=f.map(m=>{var n,p,q=m.D6a,r=m.yea,t=m.sFa;const u=m.color,w=m.weight;m=m.Sb;const x=l?-1:1,z=
null===(n=g.get(a6(q,t)))||void 0===n?void 0:n.Ja;n=null===(p=g.get(a6(r,t)))||void 0===p?void 0:p.qa;if(null!=z&&null!=n){p=B(h.get(t.xa));var A=B(k.get(q.column));q=B(k.get(r.column));t="start"===t.boundary?p.start:p.end;p=A.start;r="start"===r.boundary?q.start:q.end;return{color:u,weight:w,Sb:m,p1:new __c.Jr(p+z*x,t),p2:new __c.Jr(r+n*x,t),...__c.hw((r-p)*x,m*w,z)}}}).filter(__c.ub);return[...e.map(m=>{var n,p,q=m.ita,r=m.K6a,t=m.Bea;const u=m.color,w=m.weight;m=m.Sb;const x=null===(n=g.get(a6(q,
r)))||void 0===n?void 0:n.Ga;n=null===(p=g.get(a6(q,t)))||void 0===p?void 0:p.ra;if(null!=x&&null!=n){p=B(k.get(q.column));var z=B(h.get(r.xa));r=B(h.get(t.xa));q="start"===q.boundary?p.start:p.end;p=z.start;t="start"===t.boundary?r.start:r.end;return{color:u,weight:w,Sb:m,p1:new __c.Jr(q,p+x),p2:new __c.Jr(q,t+n),...__c.hw(t-p,m*w,x)}}}).filter(__c.ub),...a]},QAb=function(a){const b=[];a=a.filter(c=>0!==c.weight&&null!=c.color);a=__c.rd(a,c=>c.weight);a=Array.from(a.entries()).sort(([c],[d])=>c-
d);for(const [c,d]of a){a=__c.rd(d,e=>`${e.Ki}_${e.Li}`);for(const [,e]of a){const {Li:f,Ki:g}=e[0];a=__c.rd(e,h=>h.color);for(const [h,k]of a)b.push({weight:c,color:h,lines:k,Ki:g,Li:f})}}return b},SAb=function(a,b,c,d){var e=RAb;b=b.flatMap(f=>a.rows.last()===f?[{xa:f,boundary:"start"},{xa:f,boundary:"end"}]:[{xa:f,boundary:"start"}]);c=c.flatMap(f=>a.cols.last()===f?[{column:f,boundary:"start"},{column:f,boundary:"end"}]:[{column:f,boundary:"start"}]);d=PAb(e,a,b,c,e.uQa(d));return QAb(d)},MAb=
function(a,b,c,d,e){const f=[];for(const l of c)for(const m of d){c=l.xa;var g=m.column,h=nj(b.cells,g,c);if(!h||h.span.uc===c)if(c=b6(a.hK,b,g,c,e),c="start"===l.boundary?null===c||void 0===c?void 0:c.ra:null===c||void 0===c?void 0:c.Ga){h=f[f.length-1];g=(g=b.cols.next(g))?{column:g,boundary:"start"}:{column:B(b.cols.last()),boundary:"end"};var k;if(k=h)k=h.yea,k=k.column===m.column&&k.boundary===m.boundary;k&&(k=h.sFa,k=k.xa===l.xa&&k.boundary===l.boundary);k&&h.color===c.color&&h.weight===c.weight&&
h.Sb===c.Sb&&0===h.Sb?h.yea=g:f.push({sFa:l,D6a:m,yea:g,color:c.color,weight:c.weight,Sb:c.Sb})}}return f},NAb=function(a,b,c,d,e){const f=[];for(const l of d)for(const m of c){var g=m.xa;d=l.column;var h=nj(b.cells,d,g);if(!h||h.span.oc===d)if(d=b6(a.hK,b,d,g,e),d="start"===l.boundary?null===d||void 0===d?void 0:d.qa:null===d||void 0===d?void 0:d.Ja){h=f[f.length-1];g=(g=b.rows.next(g))?{xa:g,boundary:"start"}:{xa:B(b.rows.last()),boundary:"end"};var k;if(k=h)k=h.ita,k=k.column===l.column&&k.boundary===
l.boundary;k&&(k=h.Bea,k=k.xa===m.xa&&k.boundary===m.boundary);k&&h.color===d.color&&h.weight===d.weight&&h.Sb===d.Sb&&0===h.Sb?h.Bea=g:f.push({ita:l,K6a:m,Bea:g,color:d.color,weight:d.weight,Sb:d.Sb})}}return f},OAb=function(a,b,c,d){const e=(p,q)=>{var r=a.hK.eRa(b);const t=r.get(p)||0;r=r.get(q)||0;return t<=r?p:q},f=new Map;if(0===c.length||0===d.length)return f;var g=[],h=b.cols.ec(d[0].column);h&&g.push({column:h,boundary:"start"});g.push(...d);(d=b.cols.next(d[d.length-1].column))&&g.push({column:d,
boundary:"start"});d=[];(h=b.rows.ec(c[0].xa))&&d.push({xa:h,boundary:"start"});d.push(...c);(c=b.rows.next(c[c.length-1].xa))&&d.push({xa:c,boundary:"start"});for(const p of g){c=(g="start"===p.boundary?p.column:void 0)?b.cols.ec(g):b.cols.last();for(const q of d){var k="start"===q.boundary?q.xa:void 0;h=k?b.rows.ec(k):b.rows.last();var l=b6(a.hK,b,g,k),m=b6(a.hK,b,g,h);k=b6(a.hK,b,c,k);var n=b6(a.hK,b,c,h);h="end"===p.boundary?null===k||void 0===k?void 0:k.Ja:null===l||void 0===l?void 0:l.qa;l=
"end"===q.boundary?null===m||void 0===m?void 0:m.Ga:null===l||void 0===l?void 0:l.ra;m="end"===p.boundary?null===n||void 0===n?void 0:n.Ja:null===m||void 0===m?void 0:m.qa;k="end"===q.boundary?null===n||void 0===n?void 0:n.Ga:null===k||void 0===k?void 0:k.ra;n=__c.ew({ra:m,Ga:h,qa:k,Ja:l},e);let r;switch(n){case "blockStart":r=m;break;case "blockEnd":r=h;break;case "inlineStart":r=k;break;case "inlineEnd":r=l;break;default:r=void 0}const {height:t,width:u}=1===(null===r||void 0===r?void 0:r.Sb)?{height:r.weight,
width:r.weight}:{height:Math.max((null===k||void 0===k?void 0:k.weight)||0,(null===l||void 0===l?void 0:l.weight)||0),width:Math.max((null===m||void 0===m?void 0:m.weight)||0,(null===h||void 0===h?void 0:h.weight)||0)};f.set(a6(p,q),__c.bw(n,t/2,u/2))}}return f},b6=function(a,b,c,d,e){if(c&&d)return a.R4a(b,e).get(`${c.id}:${d.id}`)},TAb=function(a,b,c){var d,e=b?a.layout.attrs.get(Sg({q_:void 0,y_:void 0,u_:void 0}),b.span.uc,b.span.oc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=
c.get(`${b.span.oc.id}:${b.span.uc.id}`))||void 0===d?void 0:d.Ga)||!1;d={color:a.$h.color,weight:a.$h.weight,Sb:fw(a.$h.wd)};c=c6(e.q_);var f=d6(e.y_);e=e6(e.u_);return null==c&&null==f&&null==e?a.Ep?void 0:{borderStyle:d,nB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Sb:e?fw(e):d.Sb},nB:!1,hidden:b}}},UAb=function(a,b,c){var d,e=b?a.layout.attrs.get(Sg({r_:void 0,z_:void 0,v_:void 0}),b.span.uc,b.span.oc)||{}:void 0;if(b&&e){b=(null===c||
void 0===c?void 0:null===(d=c.get(`${b.span.oc.id}:${b.span.uc.id}`))||void 0===d?void 0:d.ra)||!1;d={color:a.$h.color,weight:a.$h.weight,Sb:fw(a.$h.wd)};c=c6(e.r_);var f=d6(e.z_);e=e6(e.v_);return null==c&&null==f&&null==e?a.Ep?void 0:{borderStyle:d,nB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Sb:e?fw(e):d.Sb},nB:!1,hidden:b}}},f6=function(a,b,c,d){if(!a.hidden&&!c.hidden){var e=a.nB?c.nB?void 0:c:a;return __c.dw(a.borderStyle,c.borderStyle,
b,d,null===e||void 0===e?void 0:e.borderStyle)}},VAb=function(a,b,c){var d,e=b?a.layout.attrs.get(Sg({s_:void 0,A_:void 0,w_:void 0}),b.span.uc,b.span.oc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.oc.id}:${b.span.uc.id}`))||void 0===d?void 0:d.Ja)||!1;d={color:a.$h.color,weight:a.$h.weight,Sb:fw(a.$h.wd)};c=c6(e.s_);var f=d6(e.A_);e=e6(e.w_);return null==c&&null==f&&null==e?a.Ep?void 0:{borderStyle:d,nB:!0,hidden:b}:{borderStyle:{color:null!==c&&void 0!==c?c:d.color,
weight:null!==f&&void 0!==f?f:d.weight,Sb:e?fw(e):d.Sb},nB:!1,hidden:b}}},WAb=function(a,b,c){var d,e=b?a.layout.attrs.get(Sg({t_:void 0,B_:void 0,x_:void 0}),b.span.uc,b.span.oc)||{}:void 0;if(b&&e){b=(null===c||void 0===c?void 0:null===(d=c.get(`${b.span.oc.id}:${b.span.uc.id}`))||void 0===d?void 0:d.qa)||!1;d={color:a.$h.color,weight:a.$h.weight,Sb:fw(a.$h.wd)};c=c6(e.t_);var f=d6(e.B_);e=e6(e.x_);return null==c&&null==f&&null==e?a.Ep?void 0:{borderStyle:d,nB:!0,hidden:b}:{borderStyle:{color:null!==
c&&void 0!==c?c:d.color,weight:null!==f&&void 0!==f?f:d.weight,Sb:e?fw(e):d.Sb},nB:!1,hidden:b}}},XAb=function(a,b,c){var d=b.column,e=b.xa;if(b=nj(a.cells,d,e)){var f=d===b.span.oc,g=d===b.span.yd,h=e===b.span.uc,k=e===b.span.Jd;if(f||g||h||k){var l=a.rows.ec(e),m=l?nj(a.cells,d,l):void 0,n=(l=a.rows.next(e))?nj(a.cells,d,l):void 0,p=(l=a.cols.ec(d))?nj(a.cells,l,e):void 0;l=(l=a.cols.next(d))?nj(a.cells,l,e):void 0;var q=a.rows.first(),r=e===q;q=a.rows.last();q=e===q;e=a.cols.first();e=d===e;var t=
a.cols.last();d=d===t;var u=TAb(a,m,c);t=UAb(a,b,c);var w;h=h?!r&&u&&t?f6(u,[...(null!==(w=null===m||void 0===m?void 0:m.span.columns)&&void 0!==w?w:[])].map(C=>a.Fq(C)),t,[...b.span.columns].map(C=>a.Fq(C))):null===t||void 0===t?void 0:t.borderStyle:void 0;w=TAb(a,b,c);m=UAb(a,n,c);var x;k=k?!q&&w&&m?f6(w,[...b.span.columns].map(C=>a.Fq(C)),m,[...(null!==(x=null===n||void 0===n?void 0:n.span.columns)&&void 0!==x?x:[])].map(C=>a.Fq(C))):null===w||void 0===w?void 0:w.borderStyle:void 0;w=VAb(a,p,c);
x=WAb(a,b,c);var z;f=f?!e&&w&&x?f6(w,[...(null!==(z=null===p||void 0===p?void 0:p.span.rows)&&void 0!==z?z:[])].map(C=>a.Fr(C)),x,[...b.span.rows].map(C=>a.Fr(C))):null===x||void 0===x?void 0:x.borderStyle:void 0;z=VAb(a,b,c);c=WAb(a,l,c);var A;c=g?!d&&z&&c?f6(z,[...b.span.rows].map(C=>a.Fr(C)),c,[...(null!==(A=null===l||void 0===l?void 0:l.span.rows)&&void 0!==A?A:[])].map(C=>a.Fr(C))):null===z||void 0===z?void 0:z.borderStyle:void 0;return{ra:h,Ga:k,qa:f,Ja:c}}}},c6=function(a){return null==a||
"inherit"===a?void 0:a},d6=function(a){return null==a||"inherit"===a?void 0:Number(a.split("px")[0])},e6=function(a){return null==a||"inherit"===a?void 0:a.split(" ").map(b=>{b=Number(b);return 0<b?b:void 0}).filter(__c.ub)},ZAb=function(a){const b={transform:"translate(-1000px, -1000px) scale(0)"},c={Isa:b,zD:b,Ca:{},mS:{}},d=g6(()=>({style:a.VX.style||c,OU:a.OU}),({style:f,OU:g})=>{var h;Object.assign(a.cca.style,f.Isa);Object.assign(a.VL.style,f.zD);Object.assign(a.BD.style,f.Ca);Object.assign(a.AA.style,
f.mS);({textDecoration:f}=(null===(h=a.VX.style)||void 0===h?void 0:h.Ca)||{});a.BD.classList.toggle("OQx3PQ","underline"===f);a.BD.classList.toggle("_99ezUA","line-through"===f);a.BD.classList.toggle("kppAqQ","underline line-through"===f);a.BD.style.display=g?"none":"unset"},{fireImmediately:!0,equals:h6.structural}),e=g6(()=>a.OU?void 0:a.renderer,f=>{a.H0&&"react"!==(null===f||void 0===f?void 0:f.type)?(a.H0=void 0,a.wW.remove()):a.AA.innerHTML="";switch(null===f||void 0===f?void 0:f.type){case "react":a.H0=
YAb(f.node,a.wW);a.AA.appendChild(a.wW);break;case "dom":f.render(a.AA);break;case void 0:break;default:throw new D(f);}a.OV()},{fireImmediately:!0});return()=>{d();e()}},aBb=function(a){const b=a.rw,c=a.AG,d=new $Ab(a.uX);return e=>Q5(i6,{...e,AG:c,rw:b,Nga:d})},bBb=class{equals(a){return this.type===a.type&&this.sheet===a.sheet&&this.container.equals(a.container)}constructor(a,b){this.container=a;this.sheet=b;this.type="sheet-item"}},cBb=class{get sheet(){return this.container.sheet}equals(a){return this.type===
a.type&&this.xa===a.xa&&this.column===a.column&&this.container.equals(a.container)}constructor(a,b,c){this.container=a;this.column=b;this.xa=c;this.type="sheet-item-cell";this.content=B(nj(a.sheet.config.cells,b,c)).content}},dBb=class{get items(){return this.text.items}equals(a){return this.type===a.type&&this.text===a.text&&this.container.equals(a.container)}constructor(a,b){P(this,{items:__c.S});this.container=a;this.text=b;this.type="sheet-item-cell-richtext"}},tAb=({jh:a,hR:b})=>c=>(0,__c.N)(__c.zab,
{...c,jh:a,hR:b}),j6=__webpack_require__(443763),k6=j6.Fragment,Q5=j6.jsx,l6=j6.jsxs;var U5=__webpack_require__(736241).Pi;var m6=__webpack_require__(875604),n6=m6.Component,eBb=m6.createRef,GAb=m6.PureComponent,V5=m6.useCallback,T5=m6.useMemo,fBb=m6.useState;var o6=__webpack_require__(42782),p6=o6.aD,q6=o6.EH,h6=o6.p6,$5=o6.Fl,r6=o6.LO,g6=o6.U5;var s6=__webpack_require__(240236).gn;var gBb=__webpack_require__,hBb=gBb(993864),S5=gBb.n_x(hBb)();var iBb=__webpack_require__(358579).Z;var t6=__webpack_require__(649799),u6=t6.Om,jBb=t6.kq,v6=t6.YN;var YAb=__webpack_require__(204358).createPortal;var kBb=U5(a=>{var b,c,d="rtl"===a.sheet.direction;d={H2wykw:!d,UweldA:d};const [e]=fBb(()=>zt()),f={get:V5(()=>{var g;const h=null===e||void 0===e?void 0:null===(g=e.current)||void 0===g?void 0:g.getBoundingClientRect();var k,l;g={top:0,left:0,width:null!==(k=null===h||void 0===h?void 0:h.width)&&void 0!==k?k:0,height:null!==(l=null===h||void 0===h?void 0:h.height)&&void 0!==l?l:0};return __c.is(g)},[e])};return l6("div",{className:S5("nMvVqA",d),children:[l6("div",{ref:iBb(a.Vd,e),className:"_0YOFPg",
children:[Q5(a.qq,{...a,viewport:f}),Q5("div",{className:S5("Gdl7fQ",d),children:null===(c=a.Xpa)||void 0===c?void 0:null===(b=c.get())||void 0===b?void 0:b.map((g,h)=>Q5(g,{},h))})]}),"visible"===a.fmb&&l6(k6,{children:[Q5("div",{className:S5("_32sKQw",d),children:Q5(a.OMa,{...a})}),Q5("div",{className:S5("xdIsTQ",d),children:Q5(a.SMa,{...a})}),Q5("div",{className:S5("rsTRSA",d),children:Q5(a.QMa,{...a})})]})]})}),lBb=U5(a=>{a=a.content;__c.v("text2"===a.type||"text3"===a.type);switch(a.type){case "text2":return Q5(k6,
{children:a.value.aa});case "text3":return Q5(k6,{children:__c.gq.ya(a.value).cells.aa()});default:throw new D(a);}});var sAb=pAb((a,b)=>{const c=a.value;({Ii:a}=hg(__c.Rg,a.context.attrs));const d=document.createElement("div");"wrap"===a&&(d.className="dt4Dlg",d.style.overflowWrap="break-word");d.innerText=c;b.appendChild(d)});var uAb=a=>pAb((b,c)=>{const d=b.content;b=b.context;if(d.value.isEmpty)for(;c.lastChild;)c.lastChild.remove();else({Ii:b}=hg(__c.Rg,b.attrs)),"wrap"===b&&(c=c.appendChild(document.createElement("div")),c.className="dt4Dlg"),a.render({container:c,text:d.value,Ha:void 0,writingMode:1,Bd:"start",Df:mBb(d,b)})}),mBb=u6((a,b)=>{if("wrap"===b)return[];a=a.value.aa.split("\n").map(c=>c.length+1);a.pop();return a},{equals:h6.structural});var R5=class a extends n6{static A(b){P(b,{Ii:$5})}get Ii(){return hg(__c.Rg,this.props.context.attrs).Ii}render(){var b=this.props.content;const c=this.props.context;if(b.value.isEmpty)return null;b=Q5(this.props.Oj,{content:b,xa:c.xa,col:c.col,Ii:this.Ii},this.key++);return"wrap"===this.Ii?Q5("div",{className:"dt4Dlg",children:b}):Q5(k6,{children:b})}constructor(...b){super(...b);a.A(this);this.key=0}};R5=s6([Kc],R5);var nBb=4*__c.av,oBb=3*__c.av;var AAb=class{Qm(a,b){return"large"===b?nBb*a:oBb*a}constructor(){this.TYa=u6((a,b)=>{var c,d;b=b.get();return null!=b&&a.layout.rows.count()===((null===(c=b.rows)||void 0===c?void 0:c.size)||0)&&a.layout.cols.count()===((null===(d=b.columns)||void 0===d?void 0:d.size)||0)});this.UFa=jBb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.columns)||[])},{equals:__c.Kh});this.WFa=jBb(a=>{var b;return new Set((null===(b=a.get())||void 0===b?void 0:b.rows)||[])},{equals:__c.Kh});this.bXa=
u6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.UFa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of wAb(c?c.span.oc:e.column,c?c.span.yd:e.column,a.layout.cols))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Kh});this.cXa=u6((a,b)=>{var {cells:c}=b.get()||{};if(!c||0===c.size)return new Set;b=this.WFa(b);const d=new Set;for(const e of c){c=a.layout.cells.get(e.xa,e.column);for(const f of wAb(c?c.span.uc:e.xa,c?c.span.Jd:
e.xa,a.layout.rows))(0===b.size||b.has(f))&&d.add(f)}return d},{equals:__c.Kh})}};var W5=class a extends n6{static A(b){P(b,{ad:$5,uo:$5,dna:$5})}get ad(){return"rtl"===this.props.sheet.direction}get uo(){var b;const c=null===(b=this.props.ev)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.pE(c)}get dna(){var b,c,d;return null===(c=(d=this.props).YVa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return Q5(__c.mv,{Vn:"light",light:"light",Eq:"light",dark:"light",children:this.qQa})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
p6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"column",f)});this.onMouseLeave=p6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.u4a=()=>{const {sheet:c,MGa:d,Xya:e,Qm:f,scale:g=1}=this.props;let h=-1;return Q5("div",{style:void 0,className:S5("Vt2_4w",{jNbTIg:!this.ad,gtA7Dw:this.ad},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.cols.map(k=>{h++;return Q5(pBb,{col:k,label:__c.EZ(h),
Fma:d,jr:e,Qm:f,scale:g},k.id)})})};this.qQa=c=>{var d;const e={jNbTIg:!this.ad,gtA7Dw:this.ad};return l6("div",{ref:null===(d=this.uo)||void 0===d?void 0:d.Xf,className:S5("xhBZaw",e,c.className),children:[void 0,this.u4a()]})}}};W5=s6([Kc],W5);
var X5=class a extends n6{static A(b){P(b,{ad:$5,uo:$5,dna:$5})}get ad(){return"rtl"===this.props.sheet.direction}get uo(){var b;const c=null===(b=this.props.ev)||void 0===b?void 0:b.get();if(null!=c&&0!==c.length)return new __c.pE(c)}get dna(){var b,c,d;return null===(c=(d=this.props).YVa)||void 0===c?void 0:null===(b=c.call(d))||void 0===b?void 0:b.get()}render(){return Q5(__c.mv,{Vn:"light",light:"light",Eq:"light",dark:"light",children:this.d5a})}constructor(...b){super(...b);a.A(this);this.onMouseMove=
p6(c=>{const {onMouseMove:d,sheet:e,scale:f=1}=this.props;null===d||void 0===d?void 0:d(c,e,"row",f)});this.onMouseLeave=p6(c=>{var d,e;null===(d=(e=this.props).onMouseLeave)||void 0===d?void 0:d.call(e,c)});this.C4a=()=>{const {sheet:c,NGa:d,sza:e,Qm:f,scale:g=1}=this.props;let h=-1;return Q5("div",{style:void 0,className:S5("_93roJg",{jNbTIg:!this.ad,gtA7Dw:this.ad},{Tn3nUw:void 0}),onMouseMove:this.onMouseMove,onMouseLeave:this.onMouseLeave,children:c.rows.map(k=>{h++;return Q5(qBb,{xa:k,label:`${h+
1}`,Fma:d,jr:e,Qm:f,scale:g},k.id)})})};this.d5a=c=>{var d;const e={jNbTIg:!this.ad,gtA7Dw:this.ad};return l6("div",{ref:null===(d=this.uo)||void 0===d?void 0:d.Xf,className:S5("An9VeA",e,c.className),children:[void 0,this.C4a()]})}}};X5=s6([Kc],X5);
var pBb=U5(a=>{const {label:b,col:c,Fma:d,jr:e,Qm:f,scale:g=1}=a;a=f(g);const h=v6(()=>d(c)),k=v6(()=>e(c));return Q5("div",{className:S5("_83Rssw","d2uLIA",{YbLr8g:h,sTqdww:k}),style:{width:c.width*g,height:a},children:Q5(xAb,{label:b,width:c.width,height:f(1),scale:g,highlight:h,selected:k})})}),qBb=U5(a=>{const {label:b,xa:c,Fma:d,jr:e,Qm:f,scale:g=1}=a;a=f(g);const h=v6(()=>d(c)),k=v6(()=>e(c));return Q5("div",{className:S5("_83Rssw","JhBzyw",{YbLr8g:h,sTqdww:k}),style:{width:a,height:c.height*
g},children:Q5(xAb,{label:b,width:f(1),height:c.height,scale:g,highlight:h,selected:k})})});var rBb='<svg width="12" height="12" viewBox="0 0 12 12" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="6" cy="6" r="5.5"/></svg>';var sBb='<svg width="24" height="24" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg"><circle stroke="currentColor" cx="12" cy="12" r="9.25" stroke-width="1.5"/></svg>';var yAb=__c.NT({vm:rBb,medium:sBb});var Y5=class a extends n6{static A(b){P(b,{bd:$5.struct})}constructor(...b){super(...b);a.A(this)}render(){return Q5(this.props.qq,{sheet:this.props.element.config,ev:this.props.ev,Zx:this.props.Zx,ly:this.props.ly,scaleFactor:this.props.scaleFactor,bd:this.bd,Oj:this.props.Oj,GG:void 0,fR:void 0})}get bd(){const b=this.props.Kd,c=this.props.element.altText;return c?c.Md&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}};Y5=s6([Kc],Y5);var tBb=class{constructor(){this.O7=new WeakMap;this.uWa=a=>this.O7.get(a);this.tGa=(a,b)=>{this.O7.set(a,b)};this.$Pa=(a,b)=>{const c=this.O7.get(a);c&&c.Eb===b.Eb&&c.Ub===b.Ub&&c.Cg===b.Cg&&this.O7.delete(a)}}};var vBb=U5(a=>{const b=a.Eb,c=a.item,d=a.Cg,e=a.Ub,f=a.Td,g=a.col,h=a.xa,k=a.content,l=a.Ii;a=a.yt;__c.v("text3"===k.type);__c.YI(a,__c.gq.ya(k.value),(p,q)=>__c.gq.domain.Kb(p,q));[a]=fBb(()=>new uBb(c,e,$5(()=>b.zoom)));const m=T5(()=>new bBb(d,c),[d,c]),n=T5(()=>{var p=new cBb(m,g,h);return new dBb(p,k.value)},[m,g,h,k.value]);return Q5(f,{Eb:b,fg:n,text:k.value,Ub:a,Df:"wrap"===l?"pre-wrap":"nowrap"})}),uBb=class extends __c.tT{static A(a){P(a,{width:r6.ref,XY:$5})}get uA(){return this.M7.uA}get XY(){const a=
(this.qha.width-this.M7.width)/2;return{left:-a,right:this.M7.width+a}}constructor(a,b,c){super();uBb.A(this);this.sheet=a;this.M7=b;this.zoom=c;this.width=0;this.marginWidth=void 0;this.qha=new __c.Ew(this.sheet,this.M7,{zoom:this.zoom.get()})}};var w6=parseInt("4px",10)||4,wBb=U5(({sheet:a,scale:b,range:c,Ss:d,Ts:e})=>{if(null!=c&&(d||e)){if(d&&e)return d=a.ra(c.Jd)+c.Jd.height,a=a.qa(c.yd)+c.yd.width,Q5("div",{style:{top:d*b,width:a*b,height:w6*b},className:S5("aX8dhQ","VGcLng")});if(d)return c=a.qa(c.yd)+c.yd.width,Q5("div",{style:{left:c*b,width:w6*b,height:a.height*b},className:S5("aX8dhQ","gl1RPg")});if(e)return c=a.ra(c.Jd)+c.Jd.height,Q5("div",{style:{top:c*b,width:a.width*b,height:w6*b},className:S5("aX8dhQ","VGcLng")})}});var EAb=U5(({sheet:a,children:b,EF:c})=>{const d=V5(f=>{c.pma(a,f)},[c,a]),e=V5(f=>{null!=f?c.GF.set(a,f):c.GF.delete(a)},[c,a]);return Q5(__c.Z$a,{direction:"rtl"===a.config.direction?"rtl":"ltr",onScroll:d,Ot:e,children:b})}),DAb=class{pma(a,b){this.onScroll&&this.onScroll(a);this.dX.set(a,b)}constructor(a){this.onScroll=a;this.GF=new WeakMap;this.dX=r6.map(new Map,{deep:!1});this.scrollTo=p6((b,c)=>{b=this.GF.get(b);null===b||void 0===b?void 0:b.scrollTo({left:Math.floor(c)})})}};var Z5=class a extends n6{static A(b){P(b,{bd:$5.struct})}render(){const b=this.props.item;return Q5("div",{ref:this.props.measureRef,className:"E8r86A",style:{width:Math.min(this.props.Ub.width,b.G)},children:Q5(this.props.FG,{sheet:b,children:Q5("div",{ref:this.props.QXa,className:"cXTiJA",style:{width:b.G,height:b.N},children:Q5(this.props.qq,{sheet:b.config,ev:this.props.ev,scaleFactor:this.props.scaleFactor,Zx:this.props.Zx,ly:this.props.ly,bd:this.bd,Oj:this.Oj,GG:this.GG,fR:void 0})})})})}get bd(){const b=
this.props.Kd,c=this.props.item.altText;return c?c.Md&&!b?{"aria-hidden":!0}:{"aria-label":c.text}:{}}constructor(...b){super(...b);a.A(this);this.Oj=U5(c=>Q5("div",{className:"wKvivQ",children:Q5(vBb,{...this.props,...c,Td:this.props.Td})}));this.GG=({sheet:c,range:d,Ss:e,Ts:f})=>Q5(wBb,{sheet:c,scale:1,range:d,Ss:e,Ts:f})}};Z5=s6([Kc],Z5);var xBb=U5(({page:a,range:b,Gpa:c})=>{if(null!=c){var d=IAb(a.sheet,b);return Q5("div",{className:"Gi9pfA",children:a.elements.map((e,f)=>null==d?Q5(c,{element:e},f):__c.gs(__c.is(e)).Go(d)&&Q5(c,{element:e},f))})}});var yBb=new __c.RZ,x6=a=>nBb*a,y6=()=>!1,JAb=U5(({page:a,ev:b,Zx:c,ly:d,M2:e,scaleFactor:f,viewport:g,q6a:h,qq:k,Oj:l,Gpa:m,Jbb:n,Ibb:p})=>{var q="rtl"===a.sheet.direction,r;const t=null!==(r=null===f||void 0===f?void 0:f.get())&&void 0!==r?r:1;r=T5(()=>({range:w})=>l6(k6,{children:[m&&Q5(xBb,{page:a,Gpa:m,range:w}),p&&Q5(p,{})]}),[a,m,p]);const u=T5(()=>U5(({sheet:w,range:x,Ss:z,Ts:A})=>{if(null!=x){var C,G=null!==(C=null===f||void 0===f?void 0:f.get())&&void 0!==C?C:1;return l6(k6,{children:[n&&
Q5(n,{range:x}),Q5(wBb,{sheet:w,scale:G,range:x,Ss:z,Ts:A})]})}}),[n,f]);b=Q5(k,{sheet:a.sheet,ev:b,Zx:c,ly:d,M2:e,scaleFactor:f,viewport:g,Oj:l,GG:u,fR:r});q=l6("div",{className:"OsKKIQ",children:[Q5("div",{className:"VDFv_A",children:b}),Q5("div",{className:"_688KWg",children:Q5(zAb,{ad:q,highlight:!1,Qm:x6,scale:t})}),Q5("div",{className:"m0cT1w",children:Q5(W5,{sheet:a.sheet,scale:t,Qm:x6,Xya:y6,MGa:y6,JO:yBb})}),Q5("div",{className:"zm537g",children:Q5(X5,{sheet:a.sheet,scale:t,Qm:x6,sza:y6,
NGa:y6,JO:yBb})})]});return h?q:b});var $Ab=class{constructor(a){this.uX=a;this.NPa=__c.iW;this.$Va=u6((b,c,d,e)=>{const f=[];e=this.hWa(b,c,d,e);c=(l,m)=>(l=__c.mj(b.cells,m,l))&&__c.Usa(l);for(const {xa:l,column:m,textAlign:n,NQa:p}of e){var g=p.width+("center"===n?0:this.NPa),h=void 0;switch(n){case "start":case "justify":e=b.qa(m);h=e+g;break;case "center":h=b.qa(m)+m.width/2;e=h-g/2;h+=g/2;break;case "end":h=b.qa(m)+m.width;e=h-g;break;default:throw new D(n);}for(g=d.indexOf(m)-1;0<=g;g--){var k=d[g];if(k!==m&&!c(l,k)||!LAb(e,
h,b.qa(k)+k.width))break;f.push({xa:l,column:k,edge:"inlineEnd"})}for(g=d.indexOf(m)+1;g<d.length;g++){k=d[g];if(k!==m&&!c(l,k)||!LAb(e,h,b.qa(k)))break;f.push({xa:l,column:k,edge:"inlineStart"})}}return f},{equals:h6.structural});this.hWa=u6((b,c,d,e)=>{const f=[];for(const m of d)for(const n of c){var g,h,k,l=b.layout.cells.get(n,m);if(!l||!l.ref.content.ref&&!l.ref.Da.ref||l.span.uc!==l.span.Jd||l.span.oc!==l.span.yd)continue;const {Ii:p,textAlign:q}=hg(__c.Rg,b.layout.attrs.get(Sg({Ii:void 0,
textAlign:void 0}),n,m)||{}),r=this.uX.ey(b,n,m);d=__c.CI(q,null===(h=l.ref)||void 0===h?void 0:null===(g=h.content.ref)||void 0===g?void 0:g.type,null===(k=l.ref.Da.ref)||void 0===k?void 0:k.type,r?()=>r.VH.type:void 0);l=e(n,m);"overflow"===p&&l&&d&&f.push({xa:n,column:m,textAlign:d,NQa:l})}return f},{equals:h6.structural})}};var a6=(a,b)=>`${a.column.id}-${a.boundary}:${b.xa.id}-${b.boundary}`,ABb=class{constructor(){this.hK=zBb;this.uQa=u6(a=>{const b=new Map;for(const {column:c,xa:d,edge:e}of a){switch(e){case "blockStart":a={ra:!0};break;case "blockEnd":a={Ga:!0};break;case "inlineStart":a={qa:!0};break;case "inlineEnd":a={Ja:!0};break;default:throw new D(e);}const f=`${c.id}:${d.id}`;b.set(f,{...b.get(f),...a})}return b});this.qWa=u6(a=>{const b=new Map;let c=0;a.rows.forEach(d=>{const e=c,f=e+d.height;b.set(d,{start:e,
end:f});c=f});return b});this.PVa=u6(a=>{const b=new Map;var c="rtl"===a.direction;const d=c?-1:1;let e=0;c&&(c=a.cols.last(),e=null!=c?a.qa(c)+c.width:0);a.cols.forEach(f=>{const g=e,h=g+f.width*d;b.set(f,{start:g,end:h});e=h});return b})}},BBb=class{constructor(){this.R4a=u6((a,b)=>{const c=new Map;for(const d of a.rows)for(const e of a.cols){const f=`${e.id}:${d.id}`,g=XAb(a,{column:e,xa:d},b);g&&c.set(f,g)}return c},{equals:h6.identity});this.eRa=u6(a=>{const b=new Map;for(const d of a.cols)for(const e of a.rows){var c=
b6(this,a,d,e);if(!c)continue;const f=c.qa,g=c.Ja,h=c.ra;c=c.Ga;f&&b.set(f.color,(b.get(f.color)||0)+1);h&&b.set(h.color,(b.get(h.color)||0)+1);g&&d===a.cols.last()&&b.set(g.color,(b.get(g.color)||0)+1);c&&e===a.rows.last()&&b.set(c.color,(b.get(c.color)||0)+1)}return b},{equals:h6.identity})}},zBb=new BBb,RAb=new ABb;var z6=class a extends n6{static A(b){P(b,{Pma:$5({equals:h6.shallow}),Qma:$5({equals:h6.shallow}),Tya:$5({equals:h6.structural})})}componentDidMount(){const b=B(this.ref.current);wc(this,q6(()=>{var c=this.props.scaleFactor;const d=this.props.sheet;var e;c=null!==(e=null===c||void 0===c?void 0:c.get())&&void 0!==e?e:1;e=d.height;b.style.width=`${d.width*c}px`;b.style.height=`${e*c}px`}))}get Pma(){const b=this.props.sheet;return[...this.props.k9a].sort((c,d)=>b.cols.Kl(c,d))}get Qma(){const b=this.props.sheet;
return[...this.props.Ow].sort((c,d)=>b.rows.Kl(c,d))}get Tya(){return this.props.Nga.$Va(this.props.sheet,this.Qma,this.Pma,this.props.VT)}render(){var b=this.props.sheet;const c=SAb(b,this.Qma,this.Pma,this.Tya),d=b.width,e=b.height;b="rtl"===b.direction;return Q5("svg",{ref:this.ref,role:"presentation",className:S5("c6a1eQ",{H_CtIQ:!b,_8_56PQ:b}),viewBox:`0 0 ${d} ${e}`,strokeLinecap:"butt",strokeLinejoin:"miter",children:c.map(({lines:f,color:g,weight:h,Ki:k,Li:l})=>Q5("path",{stroke:g,strokeDasharray:k,
strokeDashoffset:l,strokeWidth:h,d:f.map(({p1:m,p2:n})=>`M ${m.x} ${m.y} L ${n.x} ${n.y}`).join(" ")},`${g}-${h}-${k}-${l}`))})}constructor(...b){super(...b);a.A(this);this.ref=eBb()}};z6=s6([Kc],z6);var B6=class a extends n6{static A(b){P(b,{T1:$5,vJa:$5})}render(){var b;const c=this.props.xVa;return l6("div",{ref:this.GGa,className:S5("ZTz_iA","ltr"===this.props.sheet.direction?"TA4X7w":"WvuqMw"),children:[(null===c||void 0===c?void 0:c.bPa)&&Q5(A6,{...this.props,range:c.bPa.range,Ss:!0,Ts:!0,className:"_0C8M3w",b0:this.T1}),(null===c||void 0===c?void 0:c.Z8a)&&Q5(A6,{...this.props,range:c.Z8a.range,Ss:!1,Ts:!0,className:"_7n44yg",b0:this.T1}),(null===c||void 0===c?void 0:c.dXa)&&Q5(A6,{...this.props,
range:c.dXa.range,Ss:!0,Ts:!1,className:"fF5r6w",b0:this.T1}),Q5(A6,{...this.props,range:null===c||void 0===c?void 0:null===(b=c.w8a)||void 0===b?void 0:b.range,Ss:!1,Ts:!1,className:"llILYw",b0:this.vJa})]})}componentDidMount(){const b=q6(()=>{var c=this.props,d=c.scaleFactor;c=c.sheet;const e=this.GGa.current;e&&(d=d?d.get():1,e.style.width=`${c.width*d}px`,e.style.height=`${c.height*d}px`)});wc(this,[b])}get T1(){return{type:"excluded"}}get vJa(){return{type:"hidden",RL:this.yPa}}constructor(...b){super(...b);
a.A(this);this.GGa=zt();this.yPa=(c,d)=>{var e;const f=this.props.sheet;var g=this.props.xVa;g=null===g||void 0===g?void 0:null===(e=g.w8a)||void 0===e?void 0:e.range;return null==g?!0:0<=f.cols.Kl(c,g.oc)&&0>=f.cols.Kl(c,g.yd)&&0<=f.rows.Kl(d,g.uc)&&0>=f.rows.Kl(d,g.Jd)}}};B6=s6([Kc],B6);
var A6=class a extends n6{static A(b){P(b,{EGa:$5})}get EGa(){const b=this.props.viewport,c=this.props.Ss,d=this.props.Ts;return null==b||!c&&!d?b:$5(()=>{const e=__c.qs(b.get());return __c.is({top:d?0:e.top,left:c?0:e.left,width:e.width,height:e.height})})}render(){const b=this.props.sheet,c=this.props.range,d=this.props.b0,e=this.props.GG,f=this.props.fR,g=this.props.Ss,h=this.props.Ts,k="ltr"===b.direction?"TA4X7w":"WvuqMw";return l6("div",{ref:this.hka,className:S5("i0YQww",this.props.className),
children:[Q5("div",{ref:this.rDa,className:"vUKoKg",children:l6("div",{ref:this.sDa,children:[Q5(C6,{...this.props,viewport:this.EGa,bounds:"hidden"===(null===d||void 0===d?void 0:d.type)?void 0:c,RL:"hidden"===(null===d||void 0===d?void 0:d.type)?d.RL:void 0}),Q5("div",{className:S5("DC3n2A",k),children:f&&Q5(f,{range:c})})]})}),Q5("div",{ref:this.tDa,className:S5("DC3n2A",k),children:e&&Q5(e,{sheet:b,range:c,Ss:g,Ts:h})})]})}componentDidMount(){const b=q6(()=>{var h=this.props,k=h.scaleFactor,l=
h.sheet;const m=h.range;var n=this.hka.current;const p=this.rDa.current;h=this.sDa.current;const q=this.tDa.current;k=k?k.get():1;const r=m?l.qa(m.yd)+m.yd.width-l.qa(m.oc):l.width,t=m?l.ra(m.Jd)+m.Jd.height-l.ra(m.uc):l.height;n&&(n.style.width=`${r*k}px`,n.style.height=`${t*k}px`);p&&(p.style.width=`${r*k}px`,p.style.height=`${t*k}px`);n="rtl"===l.direction;n=m?l.qa(m.oc)*k*(n?1:-1):0;l=m?-l.ra(m.uc)*k:0;h&&(h.style.transform=`translate(${n}px, ${l}px)`);q&&(q.style.transform=`translate(${n}px, ${l}px)`)}),
c=this.props.sheet;var d=this.props.M2;const e=this.props.Ss,f=this.props.Ts,g=null===d||void 0===d?void 0:d(c,e,f);d=q6(()=>{const h=this.hka.current;if(null!=h){var k=e||f?"sticky":"relative",l=f?"0px":"unset",m=e?"0px":"unset",n=e?"0px":"unset",p="rtl"===c.direction;if(null==g)h.style.position=k,h.style.top=l,h.style.left=p?"unset":m,h.style.right=p?n:"unset";else{const x=g.get();var q;h.style.position=null!==(q=x.position)&&void 0!==q?q:k;var r;h.style.top=null!==(r=x.top)&&void 0!==r?r:l;var t;
h.style.left=p?"unset":null!==(t=x.left)&&void 0!==t?t:m;var u;h.style.right=p?null!==(u=x.right)&&void 0!==u?u:n:"unset";var w;h.style.transform=null!==(w=x.transform)&&void 0!==w?w:"unset"}}});wc(this,[b,d])}constructor(...b){super(...b);a.A(this);this.hka=zt();this.rDa=zt();this.sDa=zt();this.tDa=zt()}};A6=s6([Kc],A6);
var CBb=class{constructor(){this.nS=new Map;this.D9a=(a,b,c,d)=>{const e=new CBb;for(const [f,g]of this.nS)c.has(g.xa)&&e.nS.set(f,g);c=`${b.id}:${a.id}`;d?e.nS.set(c,{width:d.width,height:d.height,xa:a,column:b}):e.nS.delete(c);return e};this.VT=(a,b)=>this.nS.get(`${b.id}:${a.id}`)}},C6=class a extends n6{static A(b){P(b,{TK:r6.shallow,uo:$5,bounds:$5,Ow:$5({equals:h6.shallow}),Noa:$5({equals:h6.shallow}),Ira:p6,N0:p6.bound})}get uo(){var b;const c=null===(b=this.props.ev)||void 0===b?void 0:b.get();
if(null!=c&&0!==c.length)return new __c.pE(c)}render(){var b;return l6("div",{ref:iBb(this.Vd,null===(b=this.uo)||void 0===b?void 0:b.Xf),children:[Q5("div",{ref:this.Jsa,className:"_5YlOqQ"}),Q5("div",{ref:this.Ssa,className:"_XCmKw"}),this.TK.map(c=>c.s3a),Q5(this.G$,{VT:this.state.VT})]})}componentDidMount(){const b=g6(()=>[this.Noa,this.Ow],([e,f])=>this.Ira(e,f),{fireImmediately:!0}),c=q6(()=>{var e=this.props,f=e.scaleFactor;e=e.sheet;const g=this.Vd.current;g&&(f=f?f.get():1,g.style.width=
`${e.width*f}px`,g.style.height=`${e.height*f}px`)}),d=this.TK.map(e=>ZAb(e));wc(this,[c,b,...d])}get bounds(){const b=this.props.sheet,c=this.props.bounds;var d,e,f,g;return{oc:null!==(d=null===c||void 0===c?void 0:c.oc)&&void 0!==d?d:b.cols.first(),yd:null!==(e=null===c||void 0===c?void 0:c.yd)&&void 0!==e?e:b.cols.last(),uc:null!==(f=null===c||void 0===c?void 0:c.uc)&&void 0!==f?f:b.rows.first(),Jd:null!==(g=null===c||void 0===c?void 0:c.Jd)&&void 0!==g?g:b.rows.last()}}get Ow(){const b=this.bounds,
c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=500*e,g=null===d||void 0===d?void 0:d.get();d=g?g.tl.y-f:b.uc?c.ra(b.uc):0;f=g?g.br.y+f:b.Jd?c.ra(b.Jd)+b.Jd.height:0;g=new Map;for(let h=b.uc;null!=h&&null!=b.Jd&&0>=c.rows.Kl(h,b.Jd);h=c.rows.next(h)){const k=c.ra(h);if(!(k+h.height<d)){if(k>f)break;g.set(h,k*e)}}return g}get Noa(){const b=this.bounds,c=this.props.sheet;var d=this.props.viewport;const e=this.props.scaleFactor.get();var f=100*e,g=null===d||void 0===
d?void 0:d.get();d=g?g.tl.x-f:b.oc?c.qa(b.oc):0;f=g?g.br.x+f:b.yd?c.qa(b.yd)+b.yd.width:0;g=new Map;for(let h=b.oc;null!=h&&null!=b.yd&&0>=c.cols.Kl(h,b.yd);h=c.cols.next(h)){const k=c.qa(h);if(!(k+h.width<d)){if(k>f)break;g.set(h,k*e)}}return g}Ira(b,c){const d=B(this.Jsa.current),e=B(this.Ssa.current),f=[],g=new Map;for(const h of this.rKa)c.has(h.xa)?g.set(h.xa,h):f.push(h);for(const [h,k]of c)c=g.get(h)||f.pop(),c||(c=new DBb(this.N0,h),d.appendChild(c.Z_),e.appendChild(c.a0),this.rKa.push(c)),
c.update(k,h,b);for(const h of f)h.hide()}N0(b,c){const d=this.props.Yca,e=this.props.sheet,f=this.props.RL;b=new EBb(this.props.AG,this.props.Oj,d(b,c),e,b,c,f,this.OV);wc(this,ZAb(b));this.TK.push(b);return b}constructor(b){super(b);a.A(this);this.Vd=zt();this.Jsa=zt();this.Ssa=zt();this.rKa=[];this.TK=[];this.G$=U5(c=>{const d=[...this.Ow.keys()],e=[...this.Noa.keys()];return Q5(this.props.NMa,{Ow:d,k9a:e,VT:c.VT})});this.OV=(c,d,e)=>{this.setState(f=>{const g=e();return f.D9a(d,c,this.Ow,g)})};
this.state=new CBb}};C6=s6([Kc],C6);
var DBb=class{static A(a){P(a,{update:p6})}update(a,b,c){[this.Z_,this.a0].forEach(d=>{d.style.transform=`translateY(${a}px)`;d.classList.add("FPpqvg")});this.xa=b;for(const [d]of c)c=this.TK.get(d),c||(c=this.N0(d,b),this.TK.set(d,c),this.Z_.appendChild(c.cca),this.a0.appendChild(c.VL)),c.update(b)}hide(){[this.Z_,this.a0].forEach(a=>{a.style.transform="translate(-1000px, -1000px) scale(0)"})}constructor(a,b){DBb.A(this);this.N0=a;this.xa=b;this.Z_=document.createElement("div");this.a0=document.createElement("div");
this.TK=new Map}},EBb=class{static A(a){P(a,{H0:r6.ref,xa:r6.ref,Ca:$5,attrs:$5,OU:$5,renderer:$5,update:p6})}get s3a(){return this.H0}get Ca(){return __c.mj(this.sheet.cells,this.col,this.xa)}get attrs(){return this.sheet.layout.attrs.get(Sg({Ii:0,textAlign:0,direction:0}),this.xa,this.col)||{}}get OU(){return this.RL?!this.RL(this.col,this.xa):!1}get renderer(){const a=this.Ca;if(a&&(a.content||a.Da))return this.AG({context:{xa:this.xa,col:this.col,sheet:this.sheet,attrs:this.attrs},yt:this.OV,
Oj:this.Oj})}update(a){this.xa=a;this.VX.xa=a}constructor(a,b,c,d,e,f,g,h){EBb.A(this);var k,l,m,n,p,q;this.AG=a;this.VX=c;this.sheet=d;this.col=e;this.RL=g;this.cca=document.createElement("div");this.VL=document.createElement("div");this.BD=document.createElement("div");this.AA=document.createElement("div");this.wW=document.createElement("div");this.x_a=()=>{if(this.renderer){var r="react"===this.renderer.type?this.wW:this.AA;if(0!==r.childNodes.length&&(r=r.childNodes[0],r instanceof HTMLElement))return{width:r.clientWidth,
height:r.clientHeight}}};this.xa=f;this.cca.className="_2JFriw";this.VL.className="imy9ug";this.BD.className=S5("pDMp7w",{_0yZ6Qg:"text3"!==(null===(l=this.Ca)||void 0===l?void 0:null===(k=l.content)||void 0===k?void 0:k.type),qhF5uA:"text3"!==(null===(n=this.Ca)||void 0===n?void 0:null===(m=n.content)||void 0===m?void 0:m.type)&&"text2"!==(null===(q=this.Ca)||void 0===q?void 0:null===(p=q.content)||void 0===p?void 0:p.type)});this.AA.className="_30B9pw";this.BD.appendChild(this.AA);this.VL.appendChild(this.BD);
this.wW.className="G7zH2w";this.OV=()=>{h(this.col,this.xa,this.x_a)};this.Oj=r=>Q5(b,{...r,yt:this.OV})}};var i6=class extends n6{render(){const a=this.props.sheet,b=this.props.ev,c=this.props.M2,d=this.props.AG,e=this.props.bd,f=this.props.Oj,g=this.props.viewport,h=this.props.GG,k=this.props.fR;return Q5("div",{className:S5("SNkrHw","ltr"===a.direction?"TA4X7w":"WvuqMw"),...e,children:Q5(B6,{AG:d,Oj:f,NMa:this.G$,Yca:this.Yca,sheet:a,ev:b,M2:c,scaleFactor:this.scaleFactor,viewport:g,GG:h,fR:k})})}get scaleFactor(){return this.props.scaleFactor?this.props.scaleFactor:$5(()=>1)}constructor(...a){super(...a);
this.G$=U5(b=>Q5(z6,{...b,sheet:this.props.sheet,scaleFactor:this.scaleFactor,Nga:this.props.Nga}));this.Yca=(b,c)=>new __c.ata(this.props.rw,this.props.sheet,b,c,this.scaleFactor,this.Zx,this.ly);this.Zx=(b,c)=>{var d,e;return null===(d=(e=this.props).Zx)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)};this.ly=(b,c)=>{var d,e;return null===(d=(e=this.props).ly)||void 0===d?void 0:d.call(e,this.props.sheet,b,c)}}};i6=s6([Kc],i6);__c.fta={$Xa:function(a){const b=a.Ol,c=a.Id,d=a.Fc,e=a.hm,f=a.uX,g=a.rw,h=a.sR;vAb({qw:a.qw,jh:a.jh,n7a:a.YJ});const k=aBb({AG:h,uX:f,rw:g});b.Y$=KAb({qq:k});c.H$=CAb({qq:k});({RMa:a}=HAb({qq:k,Td:e(),DGa:new tBb}));d.On.X$=a;const {YKa:l,ZKa:m,XKa:n}=BAb();return{gqa:U5(p=>Q5(kBb,{...p,qq:k,QMa:l,SMa:m,OMa:n,Oj:lBb}))}}};
}).call(self, self._fe4d99ebe0d2d259646a80d250150d47);}

}])
//# sourceMappingURL=sourcemaps/2779702f4c99fba4.js.map